siac.Certificacao=siac.Certificacao||{};siac.Certificacao.Gerar=function(){function n(){$(".ui.dropdown").dropdown();$(".ui.modal").modal();$(".ui.termo.modal").modal("show");$(".cancelar.button").popup({on:"click"});$(".ui.confirmar.modal").modal({onApprove:function(){$("form").addClass("loading").submit()}});$(".prosseguir.button").click(function(){t()});$("#ddlDisciplina").change(function(){r(this.value)});$("#ddlTipo").change(function(){u(this.value)})}function t(){var t=$("form .error.message .list"),n;t.html("");$("form").removeClass("error");n=!0;$("#ddlDisciplina").val()||(t.append("<li>Selecione uma disciplina<\/li>"),n=!1);$("#ddlTemas").val()||(t.append("<li>Selecione ao menos um tema<\/li>"),n=!1);$("#ddlTipo").val()||(t.append("<li>Selecione o tipo das quest\u00f5es da sua avalia\u00e7\u00e3o acad\u00eamica<\/li>"),n=!1);$("#ddlTipo").val()!=1&&$("#ddlTipo").val()!=3||$("#txtQteObjetiva").val()||(t.append("<li>Indique a quantidade das quest\u00f5es objetivas<\/li>"),n=!1);$("#ddlTipo").val()!=2&&$("#ddlTipo").val()!=3||$("#txtQteDiscursiva").val()||(t.append("<li>Indique a quantidade das quest\u00f5es discursivas<\/li>"),n=!1);$("#ddlDificuldade").val()||(t.append("<li>Selecione a dificuldade das quest\u00f5es<\/li>"),n=!1);n?i():($("form").addClass("error"),$("html, body").animate({scrollTop:$("form .error.message").offset().top},1e3))}function i(){$modal=$(".ui.confirmar.modal");$ddlDisciplina=$("#ddlDisciplina :selected");$ddlTipo=$("#ddlTipo");$table=$modal.find("tbody").html("");$tr=$("<tr><\/tr>");$tdDisciplina=$("<td><\/td>").html("<b>"+$ddlDisciplina.text()+"<\/b>");$tdTemas=$('<td class="ui labels"><\/td>');$ddlTemas=$("#ddlTemas :selected");for(var n=0;n<$ddlTemas.length;n++)$tdTemas.append($('<div class="ui tag label"><\/div>').text($ddlTemas.eq(n).text()));$tdQteQuestoes=$('<td class="ui labels"><\/td>');($ddlTipo.val()==1||$ddlTipo.val()==3)&&$tdQteQuestoes.append($('<div class="ui label"><\/div>').html('Objetiva<div class="detail">'+$("#txtQteObjetiva").val()+"<\/div>"));($ddlTipo.val()==2||$ddlTipo.val()==3)&&$tdQteQuestoes.append($('<div class="ui label"><\/div>').html('Discursiva<div class="detail">'+$("#txtQteDiscursiva").val()+"<\/div>"));$tdDificuldade=$("<td><\/td>").text($("#ddlDificuldade :selected").text());$table.append($tr.append($tdDisciplina).append($tdTemas).append($tdQteQuestoes).append($tdDificuldade));$modal.modal("show")}function r(n){var i=$("#ddlDisciplinas"),t=$("#ddlTemas");t.parent().addClass("loading");$.ajax({type:"POST",url:"/Tema/RecuperarTemasPorCodDisciplinaTemQuestao",data:{codDisciplina:n},success:function(n){t.html("");t.val(t.prop("defaultSelected"));$.each(n,function(n,i){t.append('<option value="'+i.CodTema+'">'+i.Descricao+"<\/option>")});t.parent().removeClass("loading")},error:function(){siac.mensagem("Erro no carregamento de Temas","Erro");t.parent().removeClass("loading")}})}function u(n){var t=$("#txtQteObjetiva"),i=$("#txtQteDiscursiva");n==1?(t.prop("disabled",!1),i.prop("disabled",!0)):n==2?(t.prop("disabled",!0),i.prop("disabled",!1)):(t.prop("disabled",!1),i.prop("disabled",!1))}return{iniciar:n}}();siac.Certificacao.Configurar=function(){function o(){$elemento=$("[data-avaliacao]");!t&&$elemento&&(t=$elemento.data("avaliacao"),$elemento.removeAttr("data-avaliacao"));f=$($(".informacoes .label .detail")[0]).html();e=$($(".informacoes .label .detail")[1]).html();$(".questoes.modal .card").map(function(){n.push($(this).attr("id"))});$(".informacoes.button").click(function(){$(".informacoes.modal").modal("show")});$(".ui.dropdown").dropdown().change(function(){s()});$(".ui.questoes.button").click(function(){$(".questoes.modal").modal("show")});$(".ui.detalhe.button").click(function(){var t=$(this).parents(".card").attr("id");u(t,this);console.log(n)});$(".ui.acao.button").click(function(){var n;$_this=$(this);$_this.html()=="Adicionar"?(n=$_this.parents(".card").attr("id"),i(n)):$_this.html()=="Remover"&&(n=$_this.parents(".card").attr("id"),r(n))})}function s(){var n=$("#ddlTemas").val(),f=$("#ddlDificuldade").val(),e=$("#ddlTipo").val();n&&f&&e&&($resultado=$(".resultado .cards"),$resultado.addClass("form loading"),$.ajax({type:"POST",url:"/dashboard/avaliacao/certificacao/CarregarQuestoes/",data:{codigo:t,temas:n,dificuldade:f,tipo:e},success:function(n){$resultado.html(n)},error:function(n){siac.mensagem(n,"Error")},complete:function(){$resultado.removeClass("form loading");$(".acao.button").off("click");$resultado.find(".acao.button").click(function(){var n;$_this=$(this);$_this.html()=="Adicionar"?(n=$_this.parents(".card").attr("id"),i(n)):$_this.html()=="Remover"&&(n=$_this.parents(".card").attr("id"),r(n))});$(".ui.detalhe.button").click(function(){var n=$(this).parents(".card").attr("id");u(n,this)})}}))}function i(t){$card=$("#"+t+".card");$card.find(".acao.button").off("click");n.push(t);$card.transition({onHide:function(){$(".questoes.modal .cards").append($card)}}).transition("scale")}function r(t){$card=$("#"+t+".card");var i=n.indexOf(t);i>-1&&n.splice(i,1);$card.transition({onHide:function(){$card.remove()}}).transition("scale")}function u(n,t){$_this=$(t);$_this.addClass("loading");$.ajax({type:"POST",url:"/dashboard/avaliacao/certificacao/CarregarQuestao/",data:{codQuestao:n},success:function(t){$(".questao.modal .header").html("Quest\u00e3o "+n);$(".questao.modal .segment").html(t);$(".accordion").accordion();$(".questao.modal").modal("show")},error:function(n){siac.mensagem(n,"Error")},complete:function(){$_this.removeClass("loading")}})}var t,n=[],f,e;return{iniciar:o}}();