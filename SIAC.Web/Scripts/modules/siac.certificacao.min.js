siac.Certificacao=siac.Certificacao||{};siac.Certificacao.Gerar=function(){function n(){$(".ui.dropdown").dropdown();$(".ui.modal").modal();$(".ui.termo.modal").modal({closable:!1}).modal("show");$(".cancelar.button").popup({on:"click"});$(".ui.confirmar.modal").modal({onApprove:function(){$("form").addClass("loading").submit()}});$(".prosseguir.button").click(function(){t()});$("#ddlDisciplina").change(function(){r(this.value)});$("#ddlTipo").change(function(){u(this.value)})}function t(){var t=$("form .error.message .list"),n;t.html("");$("form").removeClass("error");n=!0;$("#ddlDisciplina").val()||(t.append("<li>Selecione uma disciplina<\/li>"),n=!1);$("#ddlTemas").val()||(t.append("<li>Selecione ao menos um tema<\/li>"),n=!1);$("#ddlTipo").val()||(t.append("<li>Selecione o tipo das quest\u00f5es da sua avalia\u00e7\u00e3o acad\u00eamica<\/li>"),n=!1);$("#ddlTipo").val()!=1&&$("#ddlTipo").val()!=3||$("#txtQteObjetiva").val()||(t.append("<li>Indique a quantidade das quest\u00f5es objetivas<\/li>"),n=!1);$("#ddlTipo").val()!=2&&$("#ddlTipo").val()!=3||$("#txtQteDiscursiva").val()||(t.append("<li>Indique a quantidade das quest\u00f5es discursivas<\/li>"),n=!1);$("#ddlDificuldade").val()||(t.append("<li>Selecione a dificuldade das quest\u00f5es<\/li>"),n=!1);n?i():($("form").addClass("error"),$("html, body").animate({scrollTop:$("form .error.message").offset().top},1e3))}function i(){$modal=$(".ui.confirmar.modal");$ddlDisciplina=$("#ddlDisciplina :selected");$ddlTipo=$("#ddlTipo");$table=$modal.find("tbody").html("");$tr=$("<tr><\/tr>");$tdDisciplina=$("<td><\/td>").html("<b>"+$ddlDisciplina.text()+"<\/b>");$tdTemas=$('<td class="ui labels"><\/td>');$ddlTemas=$("#ddlTemas :selected");for(var n=0;n<$ddlTemas.length;n++)$tdTemas.append($('<div class="ui tag label"><\/div>').text($ddlTemas.eq(n).text()));$tdQteQuestoes=$('<td class="ui labels"><\/td>');($ddlTipo.val()==1||$ddlTipo.val()==3)&&$tdQteQuestoes.append($('<div class="ui label"><\/div>').html('Objetiva<div class="detail">'+$("#txtQteObjetiva").val()+"<\/div>"));($ddlTipo.val()==2||$ddlTipo.val()==3)&&$tdQteQuestoes.append($('<div class="ui label"><\/div>').html('Discursiva<div class="detail">'+$("#txtQteDiscursiva").val()+"<\/div>"));$tdDificuldade=$("<td><\/td>").text($("#ddlDificuldade :selected").text());$table.append($tr.append($tdDisciplina).append($tdTemas).append($tdQteQuestoes).append($tdDificuldade));$modal.modal("show")}function r(n){var i=$("#ddlDisciplinas"),t=$("#ddlTemas");t.parent().addClass("loading");$.ajax({type:"POST",url:"/Tema/RecuperarTemasPorCodDisciplinaTemQuestao",data:{codDisciplina:n},success:function(n){t.html("");t.val(t.prop("defaultSelected"));$.each(n,function(n,i){t.append('<option value="'+i.CodTema+'">'+i.Descricao+"<\/option>")});t.parent().removeClass("loading")},error:function(){siac.mensagem("Erro no carregamento de Temas","Erro");t.parent().removeClass("loading")}})}function u(n){var t=$("#txtQteObjetiva"),i=$("#txtQteDiscursiva");n==1?(t.prop("disabled",!1),i.prop("disabled",!0)):n==2?(t.prop("disabled",!0),i.prop("disabled",!1)):(t.prop("disabled",!1),i.prop("disabled",!1))}return{iniciar:n}}();siac.Certificacao.Configurar=function(){function y(){$elemento=$("[data-avaliacao]");!r&&$elemento&&(r=$elemento.data("avaliacao"),$elemento.removeAttr("data-avaliacao"));u=$(".informacoes .objetiva.label .detail").html();f=$(".informacoes .discursiva.label .detail").html();$(".questoes.modal .card").map(function(){n.push($(this).attr("id"));$(this).find(".tipo.label").text()==e?t++:$(this).find(".tipo.label").text()==o&&i++;console.log(n)});$(".informacoes.button").click(function(){$(".informacoes.modal").modal("show")});$(".ui.dropdown").dropdown().change(function(){p()});$(".cancelar.button").popup({on:"click"});$(".ui.confirmar.modal").modal({onApprove:function(){console.log(n);$.ajax({type:"POST",url:"/dashboard/avaliacao/certificacao/Configurar/",data:{codigo:r,questoes:n},success:function(n){n&&(window.location.href="/dashboard/avaliacao/certificacao/agendar/"+r)},error:function(){siac.aviso("error","red")}})}});$(".confirmar.button").click(function(){return $questoes=$(".questoes.modal .cards").clone(),$questoes.removeClass("three").addClass("one"),$questoes.find(".attached.buttons").remove(),$questoes.find(".card").map(function(){$header=$(this).find(".header");var n=$header.data("enunciado");n=n.substituirTodos("\n","<br>");$header.html(n);$header.css("text-align","justify")}),$(".confirmar.modal .content").html($questoes),$(".ui.confirmar.modal").modal("show"),!1});$(".ui.questoes.button").click(function(){$(".questoes.modal").modal("show")});$(".ui.detalhe.button").click(function(){var t=$(this).parents(".card").attr("id");a(t,this);console.log(n)});$(".ui.acao.button").click(function(){$_this=$(this);var n=$_this.parents(".card").find(".label").last().text(),t=$_this.parents(".card").attr("id");$_this.html()=="Adicionar"?l(t,n):$_this.html()=="Remover"&&h(t,n)});c()}function p(){var t=$("#ddlTemas").val(),i=$("#ddlDificuldade").val(),u=$("#ddlTipo").val();console.log(t);t&&i&&u&&($resultado=$(".resultado .cards"),$resultado.addClass("form loading"),$.ajax({type:"POST",url:"/dashboard/avaliacao/certificacao/CarregarQuestoes/",data:{codigo:r,temas:t,dificuldade:i,tipo:u},success:function(t){t&&($cards=$(t),$resultado.html($cards),$resultado.find(".card").map(function(){$card=$(this);var t=$card.attr("id");n.indexOf(t)>-1&&$card.find(".acao.button").text(s)}))},error:function(n){siac.mensagem(n,"Error")},complete:function(){$resultado.removeClass("form loading");$resultado.find(".acao.button").off("click").click(function(){var t,n;$_this=$(this);t=$_this.parents(".card").find(".tipo.label").text();$_this.html()==v?(n=$_this.parents(".card").attr("id"),l(n,t)):$_this.html()==s&&(n=$_this.parents(".card").attr("id"),h(n,t))});$(".ui.detalhe.button").click(function(){var n=$(this).parents(".card").attr("id");a(n,this)})}}))}function l(r,l){var a=!1;l==e?t<u?(a=!0,t++):siac.aviso("Voc\u00ea n\u00e3o pode adicionar mais quest\u00f5es objetivas","red"):l==o&&(i<f?(a=!0,i++):siac.aviso("Voc\u00ea n\u00e3o pode adicionar mais quest\u00f5es discursivas","red"));a&&($card=$("#"+r+".card"),$card.find(".acao.button").text(s).off("click").click(function(){h(r,l)}),n.push(r),$card.transition({onHide:function(){$(".questoes.modal .cards").append($card);siac.aviso("Quest\u00e3o adicionada","green");c()}}).transition("scale"))}function h(r,u){$card=$("#"+r+".card");var f=n.indexOf(r);f>-1&&(n.splice(f,1),u==e?t--:u==o&&i--);$card.transition({onHide:function(){$card.remove();siac.aviso("Quest\u00e3o removida","red");c()}}).transition("scale")}function a(t,i){$_this=$(i);$_this.addClass("loading");$.ajax({type:"POST",url:"/dashboard/avaliacao/certificacao/CarregarQuestao/",data:{codQuestao:t},success:function(i){n.indexOf(t)>-1&&(t=n.indexOf(t)+1);$(".questao.modal .header").html("Quest\u00e3o "+t);$(".questao.modal .segment").html(i);$(".accordion").accordion();$(".questao.modal").modal("show")},error:function(n){siac.mensagem(n,"Error")},complete:function(){$_this.removeClass("loading")}})}function c(){$disc=$(".quantidade.disc.label");$obj=$(".quantidade.obj.label");$disc.find(".detail").text(i);$obj.find(".detail").text(t);t==u?$obj.addClass("green"):$obj.removeClass("green");i==f?$disc.addClass("green"):$disc.removeClass("green")}var r,n=[],t=0,i=0,u,f,e="Objetiva",o="Discursiva",v="Adicionar",s="Remover";return{iniciar:y}}();siac.Certificacao.Agendar=function(){function n(){$(".ui.informacoes.modal").modal();$(".ui.dropdown").dropdown();$(".cancelar.button").popup({on:"click"});$(".ui.confirmar.modal").modal({onApprove:function(){$("form").submit()}});$(".informacoes.button").click(function(){$(".ui.informacoes.modal").modal("show")});$(".confirmar.button").click(function(){return i(),!1})}function t(){return retorno=!0,lstErro=$("form .error.message .list"),lstErro.html(""),$("form").removeClass("error"),$("#txtData").val()||(lstErro.append("<li>Especifique a data de aplica\u00e7\u00e3o<\/li>"),retorno=!1),$("#txtHoraInicio").val()||(lstErro.append("<li>Especifique a hora de \u00ednicio<\/li>"),retorno=!1),$("#txtData").val()&&$("#txtHoraInicio").val()&&(strDate=$("#txtData").val()+" "+$("#txtHoraInicio").val(),siac.Utilitario.dataEFuturo(strDate)||(lstErro.append("<li>Especifique uma data de aplica\u00e7\u00e3o futura<\/li>"),retorno=!1)),$("#txtHoraTermino").val()||(lstErro.append("<li>Especifique a hora de t\u00e9rmino<\/li>"),retorno=!1),$("#txtData").val()&&$("#txtHoraInicio").val()&&$("#txtHoraTermino").val()&&(strDateA=$("#txtData").val()+" "+$("#txtHoraInicio").val(),strDateB=$("#txtData").val()+" "+$("#txtHoraTermino").val(),siac.Utilitario.compararData(strDateA,strDateB)>=0&&(lstErro.append("<li>Especifique uma hora de t\u00e9rmino maior que a hora de in\u00edcio<\/li>"),retorno=!1)),$("#ddlSala").val()||(lstErro.append("<li>Selecione uma sala<\/li>"),retorno=!1),retorno}function i(){if($form=$("form"),t()){$div=$('<div class="ui form"><\/div>');$div.append($form.html());lstInput=$div.find(":input");$div.find(".button").remove();$div.find("#txtData").attr("value",$form.find("#txtData").val());$div.find("#txtHoraInicio").attr("value",$form.find("#txtHoraInicio").val());$div.find("#txtHoraTermino").attr("value",$form.find("#txtHoraTermino").val());for(var n=0;n<lstInput.length;n++)lstInput.eq(n).removeAttr("id").removeAttr("name").removeAttr("required").prop("readonly",!0);$(".ui.confirmar.modal .content").html("").append($div);$(".ui.confirmar.modal").modal("show")}else $form.addClass("error")}return{iniciar:n}}();siac.Certificacao.Index=function(){function c(){$(window).scroll(function(){$(window).scrollTop()+$(window).height()>$(document).height()-100&&$(".cards .card").length==h*n&&(n++,t())});$(".ui.dropdown").dropdown();$(".pesquisa input").keyup(function(){var i=this;u&&clearTimeout(u);u=setTimeout(function(){f=i.value;n=1;t()},500)});$(".button.topo").click(function(){l()});$(".categoria.item").click(function(){var u=$(this),e,f,r,o;if(n=1,e=u.attr("data-categoria"),u.hasClass("active")){for(f=i,i=[],r=0,o=f.length;r<o;r++)f[r]!=e&&i.push(f[r]);u.removeClass("active")}else i.push(e),u.addClass("active");t()});$(".disciplina.item").click(function(){var i=$(this);n=1;s=i.attr("data-disciplina");t()});$(".ordenar.item").click(function(){var i=$(this);n=1;o=i.attr("data-ordenar");t();$(".ordenar.item").removeClass("active");i.addClass("active")});t()}function t(){r&&r.readyState!=4&&r.abort();$cards=$(".ui.cards");$cards.parent().addClass("loading");r=$.ajax({url:"/Dashboard/Avaliacao/Certificacao/Listar",data:{pagina:n,ordenar:o,disciplina:s,categorias:i,pesquisa:f},method:"POST",success:function(t){t!=e&&(n==1?$cards.html(t):$cards.append(t),e=t)},complete:function(){console.log(f);$cards.parent().removeClass("loading")}})}function l(){return $("html, body").animate({scrollTop:0},500),!1}var u,e,h=12,r,n=1,o="data_desc",i=[],s="",f="";return{iniciar:c}}();siac.Certificacao.Pessoas=function(){function r(){var n=$("code#pessoas");i=JSON.parse(n.html());n.remove();$(".ui.modal").modal();$(".ui.checkbox").checkbox();$(".ui.dropdown").dropdown();$("#ddlFiltro").change(function(){u($(this).val());console.log("mudou")});$(".ui.search").search({source:t})}function u(i){n&&n.readyState!=4&&n.abort();$buscar=$(".ui.search");$buscar.addClass("loading");n=$.ajax({data:{filtro:i},type:"POST",url:"/dashboard/avaliacao/certificacao/filtrar",success:function(n){t=n;$buscar.search({source:t,onSelect:function(n){console.log(n)}})},error:function(){siac.mensagem("Um erro ocorreu.")},complete:function(){$buscar.removeClass("loading")}})}var n,i=[],t=[];return{iniciar:r}}();