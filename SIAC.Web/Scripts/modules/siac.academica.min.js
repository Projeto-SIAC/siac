siac.Academica=siac.Academica||{};siac.Academica.Agendar=function(){function n(){$(".ui.informacoes.modal").modal();$(".ui.dropdown").dropdown();$(".cancelar.button").popup({on:"click"});$(".ui.confirmar.modal").modal({onApprove:function(){$("form").addClass("loading").submit()}});$(".informacoes.button").click(function(){$(".ui.informacoes.modal").modal("show")});$(".confirmar.button").click(function(){return i(),!1})}function t(){return retorno=!0,lstErro=$("form .error.message .list"),lstErro.html(""),$("form").removeClass("error"),$("#ddlTurma").val()||(lstErro.append("<li>Selecione uma turma<\/li>"),retorno=!1),$("#txtData").val()||(lstErro.append("<li>Especifique a data de aplicação<\/li>"),retorno=!1),$("#txtHoraInicio").val()||(lstErro.append("<li>Especifique a hora de ínicio<\/li>"),retorno=!1),$("#txtData").val()&&$("#txtHoraInicio").val()&&(strDate=$("#txtData").val()+" "+$("#txtHoraInicio").val(),siac.Utilitario.dataEFuturo(strDate)||(lstErro.append("<li>Especifique uma data de aplicação futura<\/li>"),retorno=!1)),$("#txtHoraTermino").val()||(lstErro.append("<li>Especifique a hora de término<\/li>"),retorno=!1),$("#txtData").val()&&$("#txtHoraInicio").val()&&$("#txtHoraTermino").val()&&(strDateA=$("#txtData").val()+" "+$("#txtHoraInicio").val(),strDateB=$("#txtData").val()+" "+$("#txtHoraTermino").val(),siac.Utilitario.compararData(strDateA,strDateB)>=0&&(lstErro.append("<li>Especifique uma hora de término maior que a hora de início<\/li>"),retorno=!1)),$("#ddlSala").val()||(lstErro.append("<li>Selecione uma sala<\/li>"),retorno=!1),retorno}function i(){if($form=$("form"),t()){$div=$('<div class="ui form"><\/div>');$div.append($form.html());lstInput=$div.find(":input");$div.find(".button").remove();$div.find("#txtData").attr("value",$form.find("#txtData").val());$div.find("#txtHoraInicio").attr("value",$form.find("#txtHoraInicio").val());$div.find("#txtHoraTermino").attr("value",$form.find("#txtHoraTermino").val());for(var n=0;n<lstInput.length;n++)lstInput.eq(n).removeAttr("id").removeAttr("name").removeAttr("required").prop("readonly",!0);$(".ui.confirmar.modal .content").html("").append($div);$(".ui.confirmar.modal").modal("show")}else $form.addClass("error")}return{iniciar:n}}();siac.Academica.Detalhe=function(){function t(){$elemento=$("[data-avaliacao]");n=$elemento.attr("data-avaliacao");$elemento.removeAttr("data-avaliacao");$(".arquivar.button").click(function(){var t=$(this);t.addClass("loading");$.ajax({url:"/Dashboard/Avaliacao/Academica/Arquivar/"+n,type:"POST",success:function(n){n?t.addClass("active").text("Arquivada"):t.removeClass("active").text("Arquivar")},error:function(){siac.mensagem("Ocorreu um erro inesperado na tentativa de arquivar a avaliação.","Tente novamente")},complete:function(){t.removeClass("loading")}})})}var n;return{iniciar:t}}();siac.Academica.Resultado=function(){function n(){$(".ui.accordion").accordion({animateChildren:!1});$(".label, div").popup()}return{iniciar:n}}();siac.Academica.Gerar=function(){function n(){$(".ui.dropdown").dropdown();$(".ui.modal").modal();$(".ui.termo.modal").modal("show");$(".cancelar.button").popup({on:"click"});$(".ui.confirmar.modal").modal({onApprove:function(){$("form").submit()}});$("#ddlDisciplina").change(function(){r(this.value)});$("#ddlTipo").change(function(){u(this.value)});$(".prosseguir.button").click(function(){t()})}function t(){var t=$("form .error.message .list"),n;t.html("");$("form").removeClass("error");n=!0;$("#ddlDisciplina").val()||(t.append("<li>Selecione uma disciplina<\/li>"),n=!1);$("#ddlTemas").val()||(t.append("<li>Selecione ao menos um tema<\/li>"),n=!1);$("#ddlTipo").val()||(t.append("<li>Selecione o tipo das questões da sua avaliação acadêmica<\/li>"),n=!1);$("#ddlTipo").val()!=1&&$("#ddlTipo").val()!=3||$("#txtQteObjetiva").val()||(t.append("<li>Indique a quantidade das questões objetivas<\/li>"),n=!1);$("#ddlTipo").val()!=2&&$("#ddlTipo").val()!=3||$("#txtQteDiscursiva").val()||(t.append("<li>Indique a quantidade das questões discursivas<\/li>"),n=!1);$("#ddlDificuldade").val()||(t.append("<li>Selecione a dificuldade das questões<\/li>"),n=!1);n?i():($("form").addClass("error"),$("html, body").animate({scrollTop:$("form .error.message").offset().top},1e3))}function i(){$modal=$(".ui.confirmar.modal");$ddlDisciplina=$("#ddlDisciplina :selected");$ddlTipo=$("#ddlTipo");$table=$modal.find("tbody").html("");$tr=$("<tr><\/tr>");$tdDisciplina=$("<td><\/td>").html("<b>"+$ddlDisciplina.text()+"<\/b>");$tdTemas=$('<td class="ui labels"><\/td>');$ddlTemas=$("#ddlTemas :selected");for(var n=0;n<$ddlTemas.length;n++)$tdTemas.append($('<div class="ui tag label"><\/div>').text($ddlTemas.eq(n).text()));$tdQteQuestoes=$('<td class="ui labels"><\/td>');($ddlTipo.val()==1||$ddlTipo.val()==3)&&$tdQteQuestoes.append($('<div class="ui label"><\/div>').html('Objetiva<div class="detail">'+$("#txtQteObjetiva").val()+"<\/div>"));($ddlTipo.val()==2||$ddlTipo.val()==3)&&$tdQteQuestoes.append($('<div class="ui label"><\/div>').html('Discursiva<div class="detail">'+$("#txtQteDiscursiva").val()+"<\/div>"));$tdDificuldade=$("<td><\/td>").text($("#ddlDificuldade :selected").text());$table.append($tr.append($tdDisciplina).append($tdTemas).append($tdQteQuestoes).append($tdDificuldade));$modal.modal("show")}function r(n){var t=$("#ddlTemas");t.parent().addClass("loading");$.ajax({type:"POST",url:"/Tema/RecuperarTemasPorCodDisciplinaTemQuestao",data:{codDisciplina:n},success:function(n){t.html("");t.val(t.prop("defaultSelected"));for(var i=0,r=n.length;i<r;i++)t.append('<option value="'+n[i].CodTema+'">'+n[i].Descricao+"<\/option>");t.parent().removeClass("loading")},error:function(){siac.mensagem("Erro no carregamento de temas.","Erro");t.parent().removeClass("loading")}})}function u(n){var t=$("#txtQteObjetiva"),i=$("#txtQteDiscursiva");n==1?(t.prop("disabled",!1),i.prop("disabled",!0)):n==2?(t.prop("disabled",!0),i.prop("disabled",!1)):(t.prop("disabled",!1),i.prop("disabled",!1))}return{iniciar:n}}();siac.Academica.Configurar=function(){function i(){$elemento=$("[data-avaliacao]");n=$elemento.attr("data-avaliacao");$elemento.removeAttr("data-avaliacao");$(".ui.informacoes.modal").modal();$("div").popup();$(".cancelar.button").popup({on:"click"});$(".right.floated.button").popup({inline:!0,on:"click"});$(".ui.accordion").accordion({animateChildren:!1});$(".informacoes.button").click(function(){$(".informacoes.modal").modal("show")});$(".imprimir.button").click(function(){window.open("/Dashboard/Avaliacao/Academica/Imprimir/"+n,"_blank")});$(".salvar.button").click(function(){u()});t()}function t(){$(".trocar.button").off().click(function(){var n=$(this),t,i,u;t=n.parents("[data-questao]").attr("data-questao");i=n.parents("[data-indice]").attr("data-indice");u=n.parents("[data-tipo]").attr("data-tipo");r(t,i,u)});$(".desfazer.button").off().click(function(){var n=$(this),t,i,r;t=n.parents("[data-questao]").attr("data-questao");i=n.parents("[data-indice]").attr("data-indice");r=n.parents("[data-tipo]").attr("data-tipo");f(t,i,r)})}function r(i,r,u){var f=$("#CardQuestao"+r);f.addClass("ui form loading");$("#CardQuestao"+r+" div").popup("hide");$.ajax({type:"POST",url:"/Dashboard/Avaliacao/Academica/TrocarQuestao",data:{codigoAvaliacao:n,tipo:u,indice:r,codQuestao:i},success:function(n){n&&(f.html(n),$(".ui.accordion").accordion({animateChildren:!1}),$(".right.floated.button").popup({on:"click"}),$(".ui.button.disabled").removeClass("disabled"),$("#CardQuestao"+r+" .ui.desfazer.button").parents(".popup").prev().show());f.removeClass("ui form loading")},error:function(){f.removeClass("ui form loading");siac.mensagem("Ocorreu um erro não esperado.")},complete:function(){t()}})}function u(){$(".button.salvar").addClass("loading");$("form").submit()}function f(i,r,u){var f=$("#CardQuestao"+r);f.addClass("ui form loading");$("#CardQuestao"+r+" div").popup("hide");$.ajax({type:"POST",url:"/Dashboard/Avaliacao/Academica/Desfazer",data:{codigoAvaliacao:n,tipo:u,indice:r,codQuestao:i},success:function(n){n&&(f.html(n),$(".ui.accordion").accordion({animateChildren:!1}),$(".right.floated.button").popup({on:"click"}),$("#CardQuestao"+r+" .ui.desfazer.button").parents(".popup").prev().hide());f.removeClass("ui form loading")},error:function(){f.removeClass("ui form loading");siac.mensagem("Ocorreu um erro não esperado.")},complete:function(){t()}})}var n;return{iniciar:i}}();siac.Academica.Agendada=function(){function r(){t||($elemento=$("[data-categoria]"),t=$elemento.attr("data-categoria"),$elemento.removeAttr("data-categoria"));$(".ui.avaliacao.modal").modal({closable:!1});$(".card[data-avaliacao]").click(function(){u($(this).attr("data-avaliacao"))})}function u(t){$(".ui.avaliacao.modal").prop("id")==t?$(".ui.avaliacao.modal").modal("show"):($(".ui.global.loader").parent().addClass("active"),$.ajax({url:"/Historico/Avaliacao/Academica/Agendada/"+t,method:"POST",success:function(r){n=t;$(".ui.avaliacao.modal").attr("id",t).html("").append(r).modal("show");$(".ui.global.loader").parent().removeClass("active");$(".ui.avaliacao.modal .ui.accordion").accordion({animateChildren:!1,onChange:function(){$(".ui.avaliacao.modal").modal("refresh")}});$(".arquivar.button").click(function(){var t=$(this);t.addClass("loading");$.ajax({url:"/Dashboard/Avaliacao/Academica/Arquivar/"+n,type:"POST",success:function(t){t&&(window.location.href="/Dashboard/Avaliacao/Academica/Detalhe/"+n)},error:function(){t.removeClass("loading");siac.mensagem("Ocorreu um erro inesperado na tentativa de arquivar a avaliação.","Tente novamente")}})});f();i(1e3)},error:function(){siac.mensagem("Ocorreu um erro.");$(".ui.global.loader").parent().removeClass("active")}}))}function i(t){setTimeout(function(){$.ajax({type:"GET",url:"/Dashboard/Avaliacao/Academica/ContagemRegressiva",data:{codAvaliacao:n},success:function(n){$("#contagem").text(n.Tempo).parent().transition("flash");n.Tempo=="Agora"&&n.Intervalo==0&&n.FlagLiberada==!0?($(".configurar.button").hide(),$(".reagendar.button").hide(),$(".iniciar.button").removeClass("disabled"),$(".acompanhar.button").removeClass("disabled")):n.Tempo=="Agora"&&n.Intervalo==0&&n.FlagLiberada==!1&&($(".configurar.button").show(),$(".reagendar.button").show(),$(".iniciar.button").addClass("disabled"),$(".acompanhar.button").addClass("disabled"));n.Intervalo>0&&i(n.Intervalo)}})},t)}function f(){var i=$.connection.academicaHub;t==1?(i.client.liberar=function(t){var i=$("#"+t);$.ajax({type:"GET",url:"/Dashboard/Avaliacao/Academica/ContagemRegressiva",data:{codAvaliacao:n},success:function(n){alert("O professor liberou a avaliação.");n.Tempo=="Agora"&&n.Intervalo==0&&n.FlagLiberada==!0?($(".iniciar.button").removeClass("disabled").text("Iniciar"),i.find("#mensagem").html('                                        <i class="checkmark icon"><\/i>                                        <div class="content">                                            Seu professor liberou a prova                                            <div class="sub header">Você já pode iniciar<\/div>                                        <\/div>')):n.FlagLiberada==!0&&($(".iniciar.button").addClass("disabled"),i.find("#mensagem").html('                                        <i class="checkmark icon"><\/i>                                        <div class="content">                                            Seu professor liberou a prova                                            <div class="sub header">Você poderá iniciar assim que chegar a hora de aplicação<\/div>                                        <\/div>'))}})},i.client.bloquear=function(t){var i=$("#"+t);$.ajax({type:"GET",url:"/Dashboard/Avaliacao/Academica/ContagemRegressiva",data:{codAvaliacao:n},success:function(n){n.Tempo=="Agora"&&n.Intervalo==0&&n.FlagLiberada==!1&&(alert("O professor bloqueou a avaliação."),$(".iniciar.button").addClass("disabled"),i.find("#mensagem").html('                                        <i class="clock icon"><\/i>                                        <div class="content">                                            Seu professor não liberou a prova ainda                                            <div class="sub header">Aguarde a liberação da avaliação para iniciar<\/div>                                        <\/div>'))}})},$.connection.hub.start().done(function(){i.server.realizar(n)})):t==2&&$.connection.hub.start().done(function(){$(".liberar.button").click(function(){$(".liberar.button").addClass("loading");$.ajax({url:"/Dashboard/Avaliacao/Academica/AlternarLiberar",type:"POST",data:{codAvaliacao:n},success:function(t){t==!0?(i.server.liberar(n,!0),$(".liberar.button").addClass("active").removeClass("loading").text("Liberada"),$.ajax({type:"GET",url:"/Dashboard/Avaliacao/Academica/ContagemRegressiva",data:{codAvaliacao:n},success:function(n){n.Tempo=="Agora"&&n.Intervalo==0&&n.FlagLiberada==!0?($(".reagendar.button").hide(),$(".configurar.button").hide(),$(".acompanhar.button").removeClass("disabled")):($(".configurar.button").show(),$(".reagendar.button").show(),$(".acompanhar.button").addClass("disabled"))}})):(i.server.liberar(n,!1),$(".configurar.button").show(),$(".reagendar.button").show(),$(".liberar.button").removeClass("active").removeClass("loading").text("Liberar"))},error:function(){$(".liberar.button").removeClass("loading");siac.mensagem("Ocorreu um erro inesperado durante o processo. Verifique sua internet e tente novamente.","Liberar avaliação")}})})})}var n,t;return{iniciar:r}}();siac.Academica.Realizar=function(){function o(){var u,f;u=$("[data-avaliacao][data-usuario]");t=u.attr("data-avaliacao");r=u.attr("data-usuario");u.removeAttr("data-avaliacao data-usuario");u=$("[data-termino]");n=new Date;n.setTime(Date.parse(u.attr("data-termino")));u.removeAttr("data-termino");window.onbeforeunload=function(){return"Você está realizando uma avaliação."};setInterval(function(){$.ajax({type:"GET",url:"/Acesso/Conectado"})},9e5);$("a[href]").on("click",function(){return $(".ui.confirmar.modal").modal("show"),$(".ui.confirmar.modal #txtRef").val($(this).attr("href")),!1});$(".ui.checkbox").checkbox();$(".ui.informacoes.modal").modal();$(".informacoes.button").click(function(){$(".ui.informacoes.modal").modal("show")});$(".ui.confirmar.modal").modal({onApprove:function(){e($(".ui.confirmar.modal #txtRef").val())},onDeny:function(){$(".ui.segment.loading").removeClass("loading")}});$(".ui.anexo.modal").modal();$(".ui.accordion").accordion({animateChildren:!1});$(".trigger.button").popup({inline:!0,on:"click"});$(".ui.gabarito.modal").modal({onApprove:function(){return $.ajax({type:"GET",url:"/Acesso/Conectado",success:function(){i()},error:function(){siac.mensagem("Conecte-se à internet antes de confirmar.")}}),!1}});$(".message .close").click(function(){$(this).closest(".message").transition("fade")});$(".anexo.imagem.card").click(function(){s(this)});$(".desistir.button").click(function(){e()});f=new Date;$("#lblHoraInicio").text(f.getHours()+"h"+("0"+f.getMinutes()).slice(-2)+"min");$("#lblHoraTermino").text(n.getHours()+"h"+("0"+n.getMinutes()).slice(-2)+"min");h();c(n);a(t,r)}function s(n){var t=$(n),i=t.find("img").attr("src"),r=t.find(".header").text(),u=t.find(".description").text();$modal=$(".ui.anexo.modal");$modal.find(".header").text(r);$modal.find("img.image").attr("src",i);$modal.find(".description").html(u);$modal.modal("show")}function h(){setInterval(function(){date=new Date;$("#lblHoraAgora").text(date.getHours()+"h"+("0"+date.getMinutes()).slice(-2)+"min")},1e3)}function c(n){setInterval(function(){var e=n.getTimezoneOffset()*6e4,f=n.getTime()+e-((new Date).getTime()+e),t,o,r;f>0?(t=new Date,t.setTime(f),o=t.getTimezoneOffset()*6e4,t.setTime(t.getTime()+o),r=("0"+t.getHours()).slice(-2)+"h"+("0"+t.getMinutes()).slice(-2)+"min",$("#lblHoraRestante").text(r),r!=u&&$("#lblHoraRestante").parent().transition("flash"),u=r,f<3e5&&!$("#lblHoraRestante").parent().hasClass("red")&&$("#lblHoraRestante").parent().addClass("red")):(alert("O tempo de aplicação acabou, sua prova será enviada automaticamente."),$(".ui.global.loader").parent().addClass("active"),i())},1e3)}function i(){window.onbeforeunload=function(){$(".ui.global.loader").parent().addClass("active")};$("form").submit()}function l(){var t,i,r,n;for($Objects=$('textarea[name^="txtResposta"], input[name^="rdoResposta"]'),t=!0,i=0,r=$Objects.length;i<r;i++)n=$Objects.eq(i),$label=n.parents(".content").prev().find(".ui.label"),n.attr("name").indexOf("rdo")>-1?$('input[name="'+n.attr("name")+'"]:checked').length===0&&($label.removeAttr("style").addClass("red").html("Não respondida").transition("tada"),t=!1):n.val()||($label.removeAttr("style").addClass("red").html("Não respondida").transition("tada"),t=!1);return t}function f(){$modal=$(".ui.gabarito.modal");$accordion=$("form .ui.accordion").clone();$accordion.removeAttr("style");$modal.find(".content").html($('<div class="ui form"><\/div>').append($accordion));$modalAccordion=$modal.find(".ui.accordion");$modalAccordion.accordion({onChange:function(){$(".ui.gabarito.modal").modal("refresh")},animateChildren:!1});$lstInput=$modalAccordion.find(":input,a");for(var n=0,t=$lstInput.length;n<t;n++)$lstInput.eq(n).attr({readonly:"readonly"}).removeAttr("href onchange onclick").off();$modal.modal("show")}function e(n){$(".ui.global.loader").parent().addClass("active");$.ajax({url:"/Dashboard/Avaliacao/Academica/Desistir/"+t,type:"POST",success:function(){window.onbeforeunload=function(){$(".ui.global.loader").parent().addClass("active")};n||(n="/Dashboard");window.location.href=n},error:function(){$(".ui.global.loader").parent().removeClass("active");siac.mensagem("Ocorreu um erro na tentativa de desistência")}})}function a(n,r){var u=$.connection.academicaHub,e;$.connection.hub.start().done(function(){u.server.alunoConectou(n,r);i=function(){window.onbeforeunload=function(){$(".ui.global.loader").parent().addClass("active")};u.server.alunoFinalizou(n,r);$("form").submit()};$(".ui.continuar.modal").modal({onApprove:function(){u.server.alunoVerificando(n,r);f()},onDeny:function(){$("form").addClass("error");$("form .message").removeClass("hidden");$("html, body").animate({scrollTop:$(".title .label.red").offset().top},1e3)}});$(".finalizar.button").click(function(){l()?(u.server.alunoVerificando(n,r),f()):$(".continuar.modal").modal("show")});enviarMsg=function(){var t,i;$msg=$("#txtChatMensagem");$msg.val($msg.val().trim());$msg.val()&&(t=$msg.val(),t=siac.Utilitario.quebrarLinhaEm(t,30),u.server.chatAlunoEnvia(n,r,$msg.val()),$(".chat.popup .content .comments").append('                            <div class="comment" style="float:right;clear:both;">                                <div class="content">                                <div class="ui right pointing label">                                    '+t+"                                <\/div>                            <\/div>                        <\/div>                        "),$msg.val(""),i=$(".chat.popup .content .comments"),$(i).animate({scrollTop:i.children().last().offset().top},100))};$(".enviar.icon").on("click",function(){enviarMsg(this)});$("#txtChatMensagem").keypress(function(n){if(n.which==13)return enviarMsg(this),!1});$('textarea[name^="txtResposta"], input[name^="rdoResposta"]').change(function(){var t;$label=$(this).parents(".content").prev().find(".ui.label");$(this).val()?($label.removeClass("red"),$label.removeAttr("style"),$label.html("Respondida"),$(this).attr("name").indexOf("rdo")>-1?(t=$(this).attr("name").split("rdoResposta")[1],$label.find(".detail").remove(),$label.append($('<div class="detail"><\/div>').text($('input[name="'+$(this).attr("name")+'"]:checked').next().find("b").text()))):t=$(this).attr("name").split("txtResposta")[1],u.server.responderQuestao(n,r,t,!0)):(t=$(this).attr("name").indexOf("rdo")>-1?$(this).attr("name").split("rdoResposta")[1]:$(this).attr("name").split("txtResposta")[1],u.server.responderQuestao(n,r,t,!1),$label.attr("style","display:none"))});$(window).on("blur focus",function(t){var i=$(this).data("prevType");if(i!=t.type)switch(t.type){case"blur":u.server.focoAvaliacao(n,r,!1);break;case"focus":u.server.focoAvaliacao(n,r,!0)}$(this).data("prevType",t.type)})});u.client.alertar=function(n){var i=new Date,t;alert(n);t=new Date;t-i<350&&siac.mensagem(n,"O professor disse...")};u.client.enviarAval=function(t){html2canvas(document.body,{onrendered:function(i){var f=$(i),i;f.attr("id","mycanvas").hide();$("body").append(f);i=document.getElementById("mycanvas");data=i.toDataURL("image/png");$.ajax({type:"POST",url:"/Dashboard/Avaliacao/Academica/Printar",data:{codAvaliacao:n,imageData:data},success:function(){u.server.avalEnviada(t,r)},error:function(){}});f.remove()}})};e=0;u.client.chatAlunoRecebe=function(n){if(n){n=siac.Utilitario.quebrarLinhaEm(n,30);$(".chat.popup .comments").append('                            <div class="comment" style="float:left;clear:both;">                                <div class="content">                                <div class="ui left pointing label">                                    '+n+"                                <\/div>                            <\/div>                        <\/div>                        ");var t=$(".chat.popup .comments");$(t).animate({scrollTop:t.children().last().offset().top},0);$(".chat.popup").hasClass("visible")||($btnChat=$(".icon.chat.button"),$lblQteMsg=$("#lblQteMsg"),$lblQteMsg.remove(),e++,$btnChat.addClass("blue").html('<i class="icon comments outline"><\/i> '+e),document.title="Você recebeu uma mensagem - SIAC",e>1&&(document.title="Você recebeu "+e+" mensagens - SIAC"))}};$(".icon.chat.button").on("click",function(){e=0;$("#lblQteMsg").remove();$(this).removeClass("blue").html('<i class="icon comments outline"><\/i>');document.title="Realizar "+t})}var t,r,n,u;return{iniciar:o}}();siac.Academica.Acompanhar=function(){function i(){$elemento=$("[data-avaliacao][data-usuario]");n=$elemento.attr("data-avaliacao");t=$elemento.attr("data-usuario");$elemento.removeAttr("data-avaliacao data-usuario");r(n,t);$(".ui.accordion").accordion({animateChildren:!1});$(".ui.progress").progress({label:"ratio",text:{ratio:"{value} de {total}"}});$(".trigger.button").popup({inline:!0,on:"click"})}function r(n,t){var i=$.connection.academicaHub;$.connection.hub.start().done(function(){enviarMsg=function(t){var r,u;$content=$(t).parents(".content[id]");matr=$content.attr("id");$msg=$("#"+matr+"msg");$msg.val($msg.val().trim());$msg.val()&&(r=$msg.val(),r=siac.Utilitario.quebrarLinhaEm(r,30),i.server.chatProfessorEnvia(n,matr,$msg.val()),$("#"+matr+".content .chat.popup .comments").append('                            <div class="comment" style="float:right;clear:both;">                                <div class="content">                                <div class="ui right pointing label">                                    '+r+"                                <\/div>                            <\/div>                        <\/div>                        "),$msg.val(""),u=$content.find(".comments"),$(u).animate({scrollTop:u.children().last().offset().top},0))};i.server.professorConectou(n,t);$(".prova.button").on("click",function(){matr=$(this).parent().attr("id");i.server.requererAval(n,matr);$("#"+matr+".content .prova.button").addClass("loading").removeClass("transition visible")});$(".alertar.button").on("click",function(){mensagem=$(this).prev().find("textarea").val();matr=$(this).parent().parent().parent().attr("id");i.server.alertar(n,mensagem,matr);$(this).prev().find("textarea").val("");$(this).popup("hide all")});$(".enviar.icon").on("click",function(){enviarMsg(this)});$(".chat input").keypress(function(n){if(n.which==13)return enviarMsg(this),!1});setInterval(function(){lstMatr=$(".accordion").find(".title").map(function(){i.server.feed(n,this.id)})},3e3)});i.client.chatProfessorRecebe=function(n,t){if($content=$("#"+n+".content[id]"),t){t=siac.Utilitario.quebrarLinhaEm(t,30);$("#"+n+".content .chat.popup .comments").append('                            <div class="comment" style="float:left;clear:both;">                                <div class="content">                                <div class="ui left pointing label">                                    '+t+"                                <\/div>                            <\/div>                        <\/div>                        ");var i=$content.find(".comments");$(i).animate({scrollTop:i.children().last().offset().top},0);chatQteMensagem=0;$("#"+n+"lblQteMsg").length&&(chatQteMensagem=$("#"+n+"lblQteMsg").data("qte"));$("#"+n+".content .chat.popup").hasClass("visible")||($accordionChat=$("#"+n+".title"),$lblQteMsg=$("#"+n+"lblQteMsg"),$lblQteMsg.remove(),$accordionChat.append($("<div><\/div>").attr("id",n+"lblQteMsg").addClass("ui small blue label").append('<i class="ui comments icon"><\/i>')),chatQteMensagem++,$("#"+n+"lblQteMsg").data("qte",chatQteMensagem).append(chatQteMensagem))}};$(".icon.chat.button").on("click",function(){matr=$(this).parents(".content[id]").attr("id");$("#"+matr+"lblQteMsg").remove()});i.client.atualizarFeed=function(n,t){if($feed=$("#"+n+".content .feed"),$feed.html(""),$feed.append('<h4 class="ui header">Atividade<\/h4>'),t){for(var i=t.length-1;i>-1;i--)$feed.append('                        <div class="event">                            <div class="label">                                <i class="'+t[i].Icone+' icon"><\/i>                            <\/div>                            <div class="content">                                <div class="summary">                                    '+t[i].Descricao+'                                    <div class="date" title="'+t[i].DataCompleta+'">'+t[i].Data+"<\/div>                                <\/div>                            <\/div>                        <\/div>                    ");$("#"+n+"lblInfo").remove();t[t.length-1].Icone!="red warning sign"||$("#"+n+"lblWarning").length||$("#"+n).hasClass("active")?$("#"+n+"lblWarning").length||($accordionChat=$("#"+n+".title"),$accordionChat.append($("<i><\/i>").attr("id",n+"lblInfo").addClass(t[t.length-1].Icone+" icon"))):($accordionChat=$("#"+n+".title"),$accordionChat.append($("<i><\/i>").attr("id",n+"lblWarning").addClass("red warning sign icon")))}};$(".accordion .title").on("click",function(){matr=$(this).attr("id");$("#"+matr+"lblWarning").remove()});i.client.conectarAluno=function(n){$("#"+n+".title .small.label").remove();$("#"+n+".title .status.label").removeClass("red").addClass("green");$("#"+n+".content .button").removeClass("disabled")};i.client.desconectarAluno=function(n){$("#"+n+".title").append('<div class="ui small label">Desconectado<\/div>');$("#"+n+".title .status.label").removeClass("green");$("#"+n+".content .button").addClass("disabled")};i.client.alunoFinalizou=function(n){$("#"+n+".title").append('<div class="ui small label">Finalizou<\/div>');$("#"+n+".title .status.label").removeClass("green").addClass("red");$("#"+n+".content .button").addClass("disabled")};i.client.receberAval=function(t){$.ajax({type:"POST",url:"/Dashboard/Avaliacao/Academica/Printar",data:{codAvaliacao:n},success:function(n){$(".printscreen.modal .header").text($("#"+t+" .nome").text()+" ("+t+")");$(".printscreen.modal .content").css({"background-image":"url('"+n+"')"});$(".printscreen.modal .nova.guia.button").attr("href",n);$(".printscreen.modal").modal("show").modal("refresh");$("#"+t+".content .prova.button").removeClass("loading")},error:function(){siac.mensagem("Ocorreu um erro inesperado. Tente novamente mais tarde.")}})};i.client.atualizarProgresso=function(n,t){t>0&&$("#"+n+".content .progress").progress({value:t,label:"ratio",text:{ratio:"{value} de {total}"}})};i.client.respondeuQuestao=function(n,t,i){$questao=$("#"+n+'.content [data-questao="'+t+'"]');$questao.removeClass("positive").find("i").remove();i&&$questao.addClass("green")};i.client.listarChat=function(n,t){for(var u,f,r=0,e=t.length;r<e;r++)t[r].FlagAutor?i.client.chatProfessorRecebe(n,t[r].Texto):(u=t[r].Texto,u=siac.Utilitario.quebrarLinhaEm(u,30),$("#"+n+".content .chat.popup .comments").append('                        <div class="comment" style="float:right;clear:both;">                            <div class="content">                            <div class="ui right pointing label">                                '+u+"                                <\/div>                            <\/div>                        <\/div>                        "),f=$("#"+n+".content .comments"),$(f).animate({scrollTop:f.children().last().offset().top},0))}}var n,t;return{iniciar:i}}();