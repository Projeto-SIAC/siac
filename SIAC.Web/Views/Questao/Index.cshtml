    @{
        ViewBag.Title = "Minhas Questões";
        Layout = "~/Views/Shared/_Layout.cshtml";
    }

    @section Scripts {
        <script>
            $('.ui.items').parent().addClass('loading');
            var jsnQuestoesGeral;
            var jsnQuestoesFiltro;

            $.getJSON(
                '/Historico/Questao/Minhas',
                function (questoes) {
                    jsnQuestoesGeral = questoes;
                    jsnQuestoesFiltro = questoes;
                    MinhasQuestoes();
                }
            );

            function Filtro(strTexto) {
                strTexto = strTexto.toLowerCase();
                jsnQuestoesFiltro = [];
                for (var i = 0; i < jsnQuestoesGeral.length; i++) {
                    if (jsnQuestoesGeral[i].Enunciado.toLowerCase().indexOf(strTexto) > -1) {
                        jsnQuestoesFiltro.push(jsnQuestoesGeral[i]);
                    }
                    else if (jsnQuestoesGeral[i].Disciplina.toLowerCase().indexOf(strTexto) > -1) {
                        jsnQuestoesFiltro.push(jsnQuestoesGeral[i]);
                    }
                    else if (jsnQuestoesGeral[i].TipoQuestao.toLowerCase().indexOf(strTexto) > -1) {
                        jsnQuestoesFiltro.push(jsnQuestoesGeral[i]);
                    }
                    else if (jsnQuestoesGeral[i].Dificuldade.toLowerCase().indexOf(strTexto) > -1) {
                        jsnQuestoesFiltro.push(jsnQuestoesGeral[i]);
                    }
                    else if (jsnQuestoesGeral[i].DtCadastro.toLowerCase().indexOf(strTexto) > -1) {
                        jsnQuestoesFiltro.push(jsnQuestoesGeral[i]);
                    }
                    else {
                        for (var j = 0; j < jsnQuestoesGeral[i].Temas.length; j++) {
                            if (jsnQuestoesGeral[i].Temas[j].toLowerCase().indexOf(strTexto) > -1) {
                                jsnQuestoesFiltro.push(jsnQuestoesGeral[i]);
                                break;
                            }
                        }
                    }
                }
                MinhasQuestoes();
            }

            function MinhasQuestoes(pagina) {
                $('.ui.items').parent().addClass('loading');
                var qtePorPagina = 20;
                var qtePaginacao = 7;
                var length = jsnQuestoesFiltro.length;
                if (pagina == null) {
                    pagina = 1;
                }
                var count = pagina * qtePorPagina;
                if (count > length) {
                    count = length;
                }
                $('.ui.items').html('');
                for (var i = ((qtePorPagina * pagina) - qtePorPagina) ; i < count; i++) {
                    $('.ui.items').append('\
                        <div class="item">\
                            <div class="content">\
                                <a href="/Historico/Questao/' + jsnQuestoesFiltro[i].CodQuestao + '" class="header">' + ToShortString(jsnQuestoesFiltro[i].Enunciado, 140) + '</a>\
                                <div class="meta"><span title="' + jsnQuestoesFiltro[i].DtCadastro + '">' + jsnQuestoesFiltro[i].DtCadastroTempo + '</span></div>\
                                <div class="description ui labels">\
                                    <span class="ui label">' + jsnQuestoesFiltro[i].Disciplina + '</span>\
                                    <span class="ui label">' + jsnQuestoesFiltro[i].Dificuldade + '</span>\
                                    <span class="ui label">' + jsnQuestoesFiltro[i].TipoQuestao + '</span>\
                                </div>\
                            </div>\
                        </div>\
                        ');
                }
                $('.ui.pagination.menu').html('');
                var i = pagina - 3;
                for (i; i <= (Math.ceil(length / qtePorPagina)) - 3 && $('.ui.pagination.menu .item').length < 5; i++) {
                    if (i < 1) {
                        continue;
                    }
                    if (i == pagina) {
                        $('.ui.pagination.menu').append('<a class="active item" onclick="MinhasQuestoes(' + i + ')">' + i + '</a>');
                        continue;
                    }                    
                    $('.ui.pagination.menu').append('<a class="item" onclick="MinhasQuestoes(' + i + ')">' + i + '</a>');
                }
                if ($('.ui.pagination.menu .item').length < 5) {                    
                    for (i; $('.ui.pagination.menu .item').length < 5 && i <= (Math.ceil(length / qtePorPagina)) ; i++) {
                        if (i < 1) {
                            continue;
                        }
                        if (i == pagina) {
                            $('.ui.pagination.menu').append('<a class="active item" onclick="MinhasQuestoes(' + i + ')">' + i + '</a>');
                            continue;
                        }
                        $('.ui.pagination.menu').append('<a class="item" onclick="MinhasQuestoes(' + i + ')">' + i + '</a>');
                    }
                    if (pagina == (Math.ceil(length / qtePorPagina))) {
                        if (!((i - 5) < 1)) {
                            $('.ui.pagination.menu').prepend('<a class="item" onclick="MinhasQuestoes(' + (i - 5) + ')">' + (i - 5) + '</a>');
                        }
                    }
                }
                $('.ui.items').parent().removeClass('loading');
            }

            function ToShortString(str, length) {
                var text = '';

                if (str.length > length) {
                    text = str.substring(0, length);
                    var afterText = str.substring(length);
                    if (afterText.indexOf(' ') > -1) {
                        afterText = afterText.substring(0, afterText.indexOf(' '));
                        afterText = afterText + '...';
                    }
                    text = text + afterText;
                }
                else {
                    text = str;
                }

                return text;
            }
        </script>
    }
    
    <h2>@ViewBag.Title <a class="ui right floated button" href="/Dashboard/Questao/Cadastrar">Cadastrar</a></h2>
        <div class="ui fluid icon input">
            <input type="text" placeholder="Filtrar..." onkeyup="Filtro($(this).val())" />
            <i class="search icon"></i>
    </div>
    <div class="ui very relaxed items"></div>
    <div class="ui pagination menu"></div>