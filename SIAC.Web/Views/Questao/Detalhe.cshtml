
@{
    ViewBag.Title = "Questão " + Model.CodQuestao;
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@model SIAC.Models.Questao

<h2>@ViewBag.Title</h2>

<div class="ui anexo basic modal">
    <i class="close icon"></i>
    <div class="ui centered header"></div>
    <div class="image content">
        <img class="ui centered image">
    </div>
    <div class="description" style="text-align:center;"></div>
</div>

<div class="ui segment">
    @Html.Partial("_Questao", Model)    
</div>
@{ 
    var lstResposta = Model.Resposta().Where(r=>!String.IsNullOrWhiteSpace(r.RespComentario)).ToList();
}
@if(lstResposta.Count > 0) { 
<div class="ui secondary segment">
    <div class="ui dividing header">
        <p>Comentários</p>
    </div>
    @* Expor comentários dos usuários que já responderam essa questão *@
    <div class="ui comments" style="max-height: 15em; overflow-y:auto">
        @foreach (var resp in lstResposta)
        {            
            <div class="comment">
                <div class="content">
                    <a class="author">@resp.PessoaFisica.Nome.Split(' ')[0]</a>
                    <div class="metadata">
                        <span class="date">@resp.AvalTemaQuestao.AvaliacaoTema.Avaliacao.DtCadastro.ToElapsedTimeString()</span>@* Continuar: pegar data da AvalPessoaResultado *@
                    </div>
                    <div class="text">
                        @{
                            var comentario = resp.RespComentario.Split('\n', '\r');
                            foreach (var strComentario in comentario)
                            {
                                if (!String.IsNullOrWhiteSpace(strComentario))
                                {
                                    <p>@strComentario</p>
                                }
                            }
                        }
                    </div>
                </div>
            </div>            
        }
    </div>
</div>
                            }

<div data-questao="@Model.CodQuestao" class="ui arquivar toggle @(Model.FlagArquivo ? "active":"") button">
    Arquiva@(Model.FlagArquivo ? "da":"r")
</div>
<a href="/Historico/Questao/Editar/@Model.CodQuestao" class="ui button">
    Editar
</a>

@section Scripts {
    @Scripts.Render("~/bundles/js/questao")
}