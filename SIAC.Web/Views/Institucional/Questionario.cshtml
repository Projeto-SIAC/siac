@model SIAC.ViewModels.InstitucionalGerarQuestaoViewModel
@{
    ViewBag.Title = "Questionário de Av. Institucional"/* + Model.Avi.Avaliacao.CodAvaliacao*/;
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>@ViewBag.Title</h2>

<div class="ui basic confirmar modal">
    <div class="ui icon header">
        <i class="help icon"></i>
        Prosseguir operação?
    </div>
    <div class="content">
        <p>Deseja encerrar o cadastramento de questões e continuar a geração de Av. Institucional?</p>
    </div>
    <div class="actions">
        <div class="ui cancel red basic inverted button"><i class="remove icon"></i>Não</div>
        <div class="ui approve green basic inverted button"><i class="checkmark icon"></i>Sim</div>
    </div>
</div>

<div class="ui editar modal">
    <i class="close icon"></i>
    <div class="header">
        Editar Questão
    </div>
    <div class="content">
        <form class="ui segment form edicao">
            <div class="ui error message">
                <div class="header">Verifique</div>
                <ul class="list"></ul>
            </div>
            <div class="field required">
                <label for="txtEditarEnunciado">Enunciado</label>
                <textarea id="txtEditarEnunciado" name="txtEditarEnunciado" rows="2" required placeholder="Enunciado..."></textarea>
            </div>
            <div class="field">
                <label for="txtEditarObservacao">Observação</label>
                <textarea id="txtEditarObservacao" name="txtEditarObservacao" rows="2" placeholder="Observação..."></textarea>
            </div>
            <div class="alternativas">

            </div>
        </form>
    </div>
    <div class="actions">
        <div class="ui cancel button">Cancelar</div>
        <div class="ui approve button">Salvar Alterações</div>
    </div>
</div>

<form class="ui form cadastro">
    <div class="ui error message">
        <div class="header">Verifique</div>
        <ul class="list"></ul>
    </div>
    <div class="ui top attached tabular menu">
        <div class="item" data-tab="questoes">Questões da AVI</div>
        <div class="active item" data-tab="gerais">Gerais</div>
        <div class="item" data-tab="detalhes">Detalhes</div>
        <div class="item questao objetiva" data-tab="alternativas">Alternativas</div>
    </div>

    @* Questões da AVI *@
    <div class="ui bottom attached tab segment questoes" data-tab="questoes">
        <div class="ui fluid styled accordion">
            @foreach (var modulo in Model.Avi.MapQuestoes)
            {
                <div class="title"><i class="dropdown icon"></i>@modulo.Modulo.Descricao</div>
                <div class="content" data-modulo="@modulo.Modulo.CodAviModulo">
                    <div class="accordion">
                        @foreach (var categoria in modulo.Categorias)
                        {
                            <div class="title"><i class="dropdown icon"></i>@categoria.Categoria.Descricao</div>
                            <div class="content" data-categoria="@categoria.Categoria.CodAviCategoria">
                                <div class="accordion">
                                    @foreach (var indicador in categoria.Indicadores)
                                    {
                                        <div class="title"><i class="dropdown icon"></i>@indicador.Indicador.Descricao</div>
                                        <div class="content" data-indicador="@indicador.Indicador.CodAviIndicador">
                                            <div class="accordion">
                                                @foreach (var questao in indicador.Questoes)
                                                {
                                                    <div class="title">
                                                        <i class="dropdown icon"></i>
                                                        @questao.Enunciado.ToShortString(50)
                                                    </div>
                                                    <div class="content" data-questao="@questao.CodOrdem">
                                                        <div class="ui segment">
                                                            <div class="ui right floated remover button">Remover</div>
                                                            <div class="ui popup">
                                                                <div class="header">Tem certeza?</div>
                                                                <div style="padding:0!important;" class="content">
                                                                    <p>Essa ação não poderá ser desfeita.</p>
                                                                    <div class="ui right aligned remover button tiny">Sim, remover</div>
                                                                </div>
                                                            </div>
                                                            <div class="ui right floated editar button">Editar</div>
                                                            <h3 class="ui dividing header" data-content="@questao.Observacao">@questao.Enunciado.Replace(Environment.NewLine, "</br>")</h3>
                                                            
                                                                @if (questao.FlagDiscursiva.HasValue && questao.FlagDiscursiva.Value)
                                                                {
                                                                    <input class="input" placeholder="Resposta" type="text" readonly />
                                                                }
                                                                else
                                                                {
                                                                    <div class="ui very relaxed list">
                                                                        @foreach (var alternativa in questao.AviQuestaoAlternativa)
                                                                        {
                                                                            <div class="item">
                                                                                <b>@alternativa.CodAlternativa)</b> @alternativa.Enunciado
                                                                                @if (alternativa.FlagAlternativaDiscursiva)
                                                                                {
                                                                                    <div class="ui left pointing label">Alternativa discursiva</div>
                                                                                }
                                                                            </div>
                                                                        }
                                                                    </div>
                                                                }
                                                            </div>
                                                    </div>
                                                }
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>
                        }
                    </div>
                </div>
            }
        </div>
    </div>

    @* Gerais da Questão *@
    <div class="ui bottom attached active tab segment gerais" data-tab="gerais">
        <div class="field required">
            <label>Módulo</label>
            <select id="ddlModulo" name="ddlModulo" class="ui search dropdown" required>
                <option value="">Módulos</option>
                @foreach (AviModulo modulo in Model.Modulos)
                {
                    <option value="@modulo.CodAviModulo">@modulo.Descricao</option>
                }
            </select>
        </div>
        <div class="field required">
            <label>Categoria</label>
            <select id="ddlCategoria" name="ddlCategoria" class="ui search dropdown" required>
                <option value="">Categoria</option>
                @foreach (AviCategoria categoria in Model.Categorias)
                {
                    <option value="@categoria.CodAviCategoria">@categoria.Descricao</option>
                }
            </select>
        </div>
        <div class="field required">
            <label>Indicador</label>
            <select id="ddlIndicador" name="ddlIndicador" class="ui search dropdown" required>
                <option value="">Indicador</option>
                @foreach (AviIndicador indicador in Model.Indicadores)
                {
                    <option value="@indicador.CodAviIndicador">@indicador.Descricao</option>
                }
            </select>
        </div>
        <div class="field required">
            <label>Tipo</label>
            <select id="ddlTipo" name="ddlTipo" class="ui search dropdown" required>
                <option value="">Tipo</option>
                @foreach (TipoQuestao tipo in Model.Tipos)
                {
                    <option value="@tipo.CodTipoQuestao">@tipo.Descricao</option>
                }
            </select>
        </div>
    </div>

    @* Detalhes da Questão *@
    <div class="ui bottom attached tab segment detalhes" data-tab="detalhes">
        <div class="field required">
            <label for="txtEnunciado">Enunciado</label>
            <textarea id="txtEnunciado" name="txtEnunciado" rows="2" required placeholder="Enunciado..."></textarea>
        </div>
        <div class="field">
            <label for="txtObservacao">Observação</label>
            <textarea id="txtObservacao" name="txtObservacao" rows="2" placeholder="Observação..."></textarea>
        </div>
    </div>

    @* Alternativas da Questão *@
    <div class="ui bottom attached tab segment questao objetiva" data-tab="alternativas">
        <input id="txtQtdAlternativas" name="txtQtdAlternativas" type="number" hidden />
        <div class="ui adicionar button" style="float: right">Adicionar</div>
        <div class="ui alternativas fluid accordion">
        </div>
        <div class="ui form segment">
            <div class="inline fields">
                <div class="four wide field">
                    <div class="ui toggle checkbox">
                        <input name="chkAlternativaDiscursiva" id="chkAlternativaDiscursiva" type="checkbox" />
                        <label>Alternativa Discursiva</label>
                    </div>
                </div>
                <div class="twelve wide disabled field">
                    <input name="txtAlternativaDiscursiva" id="txtAlternativaDiscursiva" type="text" placeholder="Enunciado para descrição. Ex.: 'Outro', 'Mais', etc..." />
                </div>
            </div>
        </div>
    </div>
    <br />
    <div class="ui left floated cancelar button">Cancelar</div>
    <div class="ui special popup">
        <div class='header'>Tem certeza?</div>
        <div class='content'>
            <p>Você perderá todos os dados</p>
            <a href='@Url.Action("Index")' class='ui small button'>Sim, cancelar</a>
        </div>
    </div>
    <div class="ui right floated prosseguir button">Prosseguir</div>
    <center>
        <div class="ui center floated adicionar questao button">Adicionar Questão</div>
    </center>
</form>

@section Scripts{
    @Scripts.Render("~/bundles/js/institucional")
}